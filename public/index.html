<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8SEhGVYmJcqzY2MWJaWlSEgIB5roeHfbV6enOoUlJNeQAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/2pqY7Te3s/74eHS/eTk1f7l5db/5OTV/uHh0vzJybzweHhxsgAAAP8AAAD/AAAA/wAAAP8AAAD/VFMvjTc3M4HFxbfv5OTV/uXl1v/g4NH93NzN/N7e0Pzi4tT95OTV/uLi1P2MjIPHAAAA/wAAAP9oZzmtzMly/KGfW+24uKvv5OTV/uXl1v/l5db/0NDD+KCgle6Tk4nXnp6U5OLi0/3l5db/3t7P+0xMR3VEQiV6xcNu+M/MdP+Kh1bY39/Q++Xl1v/l5db/3t7P+aOjmNyHh37gjYyE5cfHufLl5db/5eXW/+Tl1f54eHGpfnxG2c7Lc/7PzHT/l5VX6NLSxPXl5db/5eXW/9fXyviurqPvp6ec96Ojl+vZ2cv25eXW/+Xl1v/j49T9aWlilI2KTvTPzHT/z8x0/8fEb/mIhmzf3t7Q++Xl1v/l5db/5eXW/+Xl1v/l5db/5eXW/+Xl1v/k5NX+tbWp5gAAAP93dkLKzspz/s/MdP/Oy3T+vrtq9oSCYN68vLDv4eHT/OTk1f7l5db/5eXW/+Tk1f7e3s/7np6T2AAAAP8AAAD/NTUcW7u4Z/PPzHT/z8x0/8/MdP/LyXH9paNd74uKX+KQkHnZmpqK4ZeXh96Pj3TeY2ND1wAAAP8AAAD/AAAA/wAAAP9LSymHurdn887Lc/7PzHT/z8x0/8/MdP/Oy3P+y8hx/MjHcPzJxnD8zMly/IOCSdEAAAD/AAAA/wAAAP8AAAD/AAAA/zUyHWCMik3VxMFt+c7Lc/7PzHT/z8x0/8/MdP/Oy3P+yMZw+4mITNMAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/y0tGF9raTukhoNJz5OQUeqSkFLpfXpEwUVFJXkAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAACEAAAAAAAAAAAAAAAAQAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAIAAAAAggAAAAAAAAAAAAAA==" rel="icon" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.1.3/dist/zephyr/bootstrap.min.css" integrity="sha256-DWNfAPc9h5qI0aI4+9aPONXiE9jIz2nczDB3KvjiKlI=" crossorigin="anonymous">
  <title>MiniChat</title>
</head>
<body class="container">
  <h1 class="mt-5">Mini Chat</h1>
  <hr />

  <form id="miFormulario">
    <div class="row">
      <div class="col-8">
        <input  
          type="text"
          id="txtMensaje"
          autocomplete="off"
          placeholder="Mensaje"
          class="form-control"
        />
      </div>
      <div class="col-4">
        <button 
          type="submit"
          class="btn btn-outline-primary"
        >
          Enviar
        </button>
      </div>
    </div>
  </form>
  <div class="row">
    <div class="col">
      <ul id="misMensajes" class=" p-0 mt-2">
      </ul>
    </div>
  </div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.1/socket.io.js" integrity="sha512-9mpsATI0KClwt+xVZfbcf2lJ8IFBAwsubJ6mI3rtULwyM3fBmQFzj0It4tGqxLOGQwGfJdk/G+fANnxfq9/cew==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    const socket = io(window?.location?.hostname || 'http://localhost:8080');
    
    const formulario = document.querySelector('#miFormulario')
    const mensajes = document.querySelector('#misMensajes')
    const mensaje = document.querySelector('#txtMensaje')

    formulario.addEventListener('submit', (ev) => {
      ev.preventDefault();

      const nuevoMensaje = mensaje.value;

      if (nuevoMensaje.trim() !== '') {

        socket.emit('mensaje-to-server', {
          texto: nuevoMensaje
        })
        mensaje.value='';

      }

    })
    
    socket.on('mensaje-from-server', (data) => {
      mensajes.innerHTML += `
        <li class="list-group-item border-0"> 
          ${data.texto} 
        </li>
      `
    })

  </script>
</body>
</html>